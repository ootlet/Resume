<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell Workstation Checker</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-powershell.min.js"></script>
</head>
<body>
    <header>
        <h1>PowerShell Workstation Checker</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="#details">Details</a></li>
                <li><a href="#workflow">Workflow</a></li>
                <li><a href="#screenshots">Screenshots</a></li>
                <li><a href="#code">Code</a></li>
            </ul>
        </nav>
    </header>

    <section id="details">
        <h2>Details</h2>
        <p>The PowerShell Workstation Checker is a robust script designed to track the real-time location status of technicians based on their workstation IP addresses. It categorizes users as "Onsite," "Remote," or "Offline" by analyzing connectivity and IP patterns. This tool is crucial for ensuring operational efficiency across multi-shift environments.</p>
    </section>

    <section id="workflow">
        <h2>Workflow</h2>
        <ol>
            <li>The user selects a shift to check (1DA, 2DA, TWI).</li>
            <li>The script reads technician and workstation data from a predefined file.</li>
            <li>For each workstation, the script tests connectivity and analyzes the IP address.</li>
            <li>Technicians are categorized as "Onsite," "Remote," or "Offline."
            <li>The results are displayed in a formatted table and exported to a text file for record-keeping.</li>
        </ol>
    </section>

    <section id="screenshots">
        <h2>Screenshots</h2>
        <div class="screenshot">
            <img src="WCMM.png" alt="Workstation Checker Menu" />
            <p>Main menu for selecting shift options.</p>
        </div>
        <div class="screenshot">
            <img src="WCSO.png" alt="Location Status Report" />
            <p>Location status report generated by the script.</p>
        </div>
        <div class="screenshot">
            <img src="WCEP.png" alt="Export Confirmation" />
            <p>Confirmation of results exported to a text file.</p>
        </div>
    </section>

    <section id="code">
        <h2>Code</h2>
        <pre>
<code class="language-powershell">
function Show-Menu {
    Clear-Host
    Write-Host "Select Which Shift you would like to check the status of"
    Write-Host "1 for 2DA"
    Write-Host "2 for TWI"
    Write-Host "3 for 1DA"
    Write-Host "4 to Exit"
    
    $Shift = Read-Host "Enter your Shift option"
    
    switch ($Shift) {
        4 { return }  # Exit
        3 { Get-LocationStatusReport1da }
        2 { Get-LocationStatusReportTwi }
        1 { Get-LocationStatusReport2da }
    }
}

function Get-LocationStatus {
    param ([string]$computerName)

    try {
        $ipAddresses = [System.Net.Dns]::GetHostAddresses($computerName) | Where-Object { $_.AddressFamily -eq 'InterNetwork' } | ForEach-Object { $_.IPAddressToString }
        foreach ($ip in $ipAddresses) {
            if (Test-Connection -ComputerName $ip -Count 1 -Quiet) {
                return if ($ip -like '*10.224*') { "Onsite" } else { "Remote" }
            }
        }
        return "Offline"
    } catch {
        return "Offline"
    }
}
</code>
        </pre>
    </section>

    <footer>
        <p>&copy; 2024 Luke Whitehouse. All rights reserved.</p>
    </footer>
</body>
</html>
